hierarchical 3FCs with softmax loss (optional: rank loss training)